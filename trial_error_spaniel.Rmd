---
title: "trial_error_spaniel"
author: "Agatha Nabilla L"
date: "5/17/2022"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
---

## Used Libraries 
These are used libraries on this code:
```{r libraries, echo=TRUE, message=FALSE, warning=FALSE}
library(Spaniel)
library(DropletUtils)
library(scater)
```


## Data 

This tutorial is generated using data from [the spaceranger testrun](https://support.10xgenomics.com/spatial-gene-expression/software/pipelines/latest/tutorials/setup-spaceranger).

```{r import the expression data, echo=TRUE, message=FALSE, warning=FALSE}

data = file.path(system.file(package="Spaniel"), "extData/outs")

sce = createVisiumSCE(tenXDir=data, resolution="Low")

```

## Adding pixel coordinates to the SCE object

Pixel coordinates are added to the object with following code:
```{r, echo=TRUE, tidy=TRUE, message=FALSE, warning=FALSE, include=TRUE}

colData(sce)[, c("Barcode", "pixel_x", "pixel_y")]
```

adding image dimensions

```{r, echo=TRUE, tidy=TRUE, warning=FALSE, message=FALSE}

metadata(sce)$ImgDims
```

sotring image as a converted pixel

```{r, echo=TRUE, tidy=TRUE, warning=FALSE, message=FALSE}

metadata(sce)$Grob
```

## Quality control and Visualisation

```{r, echo=TRUE, tidy=TRUE, warning=FALSE, message=FALSE}
filter = sce$detected > 0 
spanielPlot(object=sce, plotType="NoGenes", showFilter=filter, techType="Visium", ptSizeMax=2)
```

process only area with the gene on it 

```{r, echo=TRUE, tidy=TRUE, warning=FALSE, message=FALSE}
sce = sce[, filter]
```

normalisation 

```{r, echo=TRUE, tidy=TRUE, warning=FALSE, message=FALSE}
sce = logNormCounts(sce)

spanielPlot(object=sce, plotType = "Gene", gene="ENSMUSG00000024843", showFilter = NULL, techType = "Visium", ptSizeMax = 2)
```